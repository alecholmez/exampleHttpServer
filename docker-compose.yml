version: '2'

services:

    # zipkin tracing helper
    zipkin:
        image: openzipkin/zipkin:latest
        ports:
            - "9410:9410"
            - "9411:9411"

    # http-server uses mongo as db
    mongo:
        image: mongo:latest
        
    # actual http-server image
    http-server:
        build: .
        image: alecholmez/http-server:latest
        depends_on:
            - mongo
            - zipkin
        command: /bin/sh -c "/go/bin/govendor sync; cd h2tp && go build -o /go/bin/main && /go/bin/main"
        expose:
            - 6060
            - 9000
        ports:
            - "6060:6060"
            - "9000:9000"
